<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>地图爬取--openlayers版本</title>

    <!-- 引入样式 -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <script src="https://unpkg.com/vue@2"></script>
    <!-- 引入组件库 -->
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>

    <script src="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@main/dist/en/v7.0.0/legacy/ol.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@main/dist/en/v7.0.0/legacy/ol.css">
    <script src="./js/bd-09.js"/>
    <style type="text/css">
        #app, body, html, #map{
        height: 100%; width: 100%;
        }
    </style>
</head>
<body>
<div id="app">
    <div id="map" style=""></div>
</div>
<script type="text/javascript">
    var vue = new Vue({
        el: '#app',
        mounted() {
//             var projBD09 = new ol.proj.Projection({
//                 code: 'BD:09',
//                 extent: [-20037726.37, -11708041.66, 20037726.37, 12474104.17],
//                 units: 'm',
//                 axisOrientation: 'neu',
//                 global: false
//             });
//
//             ol.proj.addProjection(projBD09);
//             ol.proj.addCoordinateTransforms("EPSG:4326", "BD:09",
//                 function (coordinate) {
//                     return lngLatToMercator(coordinate);
//                 },
//                 function (coordinate) {
//                     return mercatorToLngLat(coordinate);
//                 }
//             );
//
//             /*定义百度地图分辨率与瓦片网格*/
//             var resolutions = [];
//             for (var i = 0; i <= 18; i++) {
//                 resolutions[i] = Math.pow(2, 18 - i);
//             }
//
//             var tilegrid = new ol.tilegrid.TileGrid({
//                 origin: [0, 0],
//                 resolutions: resolutions
//             });
//
//             /*加载百度地图离线瓦片不能用ol.source.XYZ，ol.source.XYZ针对谷歌地图（注意：是谷歌地图）而设计，
//             而百度地图与谷歌地图使用了不同的投影、分辨率和瓦片网格。因此这里使用ol.source.TileImage来自行指定
//             投影、分辨率、瓦片网格。*/
//             var source = new ol.source.TileImage({
//                 projection: "BD:09",
//                 tileGrid: tilegrid,
//                 tileUrlFunction: function (tileCoord, pixelRatio, proj) {
// //openlayer5的版本
//                     var z = tileCoord[0];
//                     var x = tileCoord[1];
//                     var y = tileCoord[2];
// // return "http://192.168.1.13:8080/mapImg/2/V1/"+z+"/"+x+"/"+y+".png";
// //return 'tiles/' + z + '/' + x + '/' + y + '.png';
//                     return "http://maponline0.bdimg.com/tile/?qt=vtile&x=" + x + "&y=" + y + "&z=" + z + "&styles=pl&scaler=1&udt=20210506&from=jsapi3_0";
//
//                     //openlayers6的版本
//                     //let z = tileCoord[0];
// // let x = tileCoord[1];
// //let y = -tileCoord[2]-1;
// // if(x<0)  x = "M"+(-x);
//                     // if(y<0) y = "M"+(-y);
//                 }
//             });

            // var mapLayer = new ol.layer.Tile({
            //     source: source
            // });

            // new ol.Map({
            //     layers: [
            //         mapLayer
            //     ],
            //     view: new ol.View({
            //         center: ol.proj.transform([113.03914, 28.20354], 'EPSG:4326', 'BD:09'),
            //         projection: 'BD:09',
            //         zoom: 14
            //     }),
            //     target: '#map'
            // });

            const map = new ol.Map({
                layers: [
                    new ol.layer.TileLayer({
                        source: new ol.source.OSM(),
                    }),
                ],
                target: 'map',
                view: new ol.View({
                    center: [0, 0],
                    zoom: 2,
                }),
            });
        }
    })
</script>
</body>
</html>
